<div id="progress-panel" class="tp-card rounded-2xl border border-ink/10 bg-white p-4 shadow-sm">
  <div class="flex flex-wrap items-start justify-between gap-3">
    <div>
      {% if plan.status == "completed" %}
        <p class="text-sm font-semibold text-emerald-700">Search completed</p>
        <p class="mt-1 text-xs font-semibold text-emerald-700">
          Completed
          {% if package_count > 0 %}| Found {{ package_count }} ranked links-only package{{ package_count|pluralize }}.{% endif %}
        </p>
      {% elif plan.status == "failed" %}
        <p class="text-sm font-semibold text-rose-700">Search failed</p>
        <p class="mt-1 text-xs text-rose-700">{{ plan.progress_message|default:"We could not finish building package options for this request." }}</p>
      {% else %}
        <p class="text-sm font-semibold text-ink">Building package options</p>
        <p class="mt-1 text-xs text-ink/70">{{ plan.progress_message|default:"Checking flights, hotels, tours, and places for your route." }}</p>
      {% endif %}
    </div>
    <div class="min-w-[120px]">
      <div class="h-2 w-full rounded-full bg-sky/30">
        <div
          class="h-2 rounded-full {% if plan.status == 'failed' %}bg-rose-500{% elif plan.status == 'completed' %}bg-emerald-500{% else %}bg-ocean{% endif %}"
          style="width: {{ plan.progress_percent|default:0 }}%;"
        ></div>
      </div>
    </div>
  </div>

  {% if plan.status == "failed" and plan.error_message %}
    <p class="tp-alert mt-3 rounded-lg bg-rose-50 px-3 py-2 text-xs text-rose-700">{{ plan.error_message }}</p>
  {% elif plan.status == "completed" and package_count == 0 %}
    <div class="mt-3 rounded-lg border border-amber-300 bg-amber-50 px-3 py-2 text-xs text-amber-900">
      Completed but no package cards were persisted. Try refresh and check provider health/fallback data.
    </div>
  {% endif %}
</div>
